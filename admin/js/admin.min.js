function randString(){var e=$("#Password_add").attr("data-character-set").split(","),t="";0<=$.inArray("a-z",e)&&(t+="abcdefghijklmnopqrstuvwxyz"),0<=$.inArray("A-Z",e)&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),0<=$.inArray("0-9",e)&&(t+="0123456789"),0<=$.inArray("#",e)&&(t+="!?%&*$#@");for(var a="",n=0;n<$("#Password_add").attr("data-size");n++)a+=t.charAt(Math.floor(Math.random()*t.length));return a}function delete_user(e){var t=dirname(window.location.href);$.confirm({boxWidth:"50%",useBootstrap:!1,title:"Benutzer löschen?",content:"Der Benutzer und alle von ihm erstellten Links und Themen sowie Zuordnungen zu Podcasts, Episoden und Vorlagen werden gelöscht!",type:"red",buttons:{ok:{text:"ok!",btnClass:"btn-primary",keys:["enter"],action:function(){$.ajax({url:t+"/inc/delete.php?delete_user=1",type:"POST",data:{user_id:e},success:function(e){console.log(e),$("#results").hide("slow"),$("#user_list").load(" #user_list > *"),$("#user_list").show("slow")}})}},cancel:{text:"abbrechen!",action:function(){}}}})}function sendOrderToServer(){var e=dirname(window.location.href);$("#cat_list").sortable();var t=$("#cat_list").sortable("serialize");$.ajax({url:e+"/inc/update.php?set_cat_order=1",type:"POST",data:t,success:function(e){console.log(e),$("#cat_list").sortable("disable")}})}function delete_template(e){var t=dirname(window.location.href);$.confirm({boxWidth:"50%",useBootstrap:!1,title:"Vorlage löschen?",content:"Die Vorlage wird gelöscht!",type:"red",buttons:{ok:{text:"ok!",btnClass:"btn-primary",keys:["enter"],action:function(){$.ajax({url:t+"/inc/delete.php?delete_template=1",type:"POST",data:{template_id:e},success:function(e){console.log(e),$("#edit").hide("slow"),$("#template_list").load(" #template_list > *"),$("#template_list").is(":hidden")&&$("#template_list").show("slow")}})}},cancel:{text:"abbrechen!",action:function(){}}}})}function delete_podcast(t,a){var e=dirname(window.location.href);$.confirm({title:"Podcast löschen?",boxWidth:"50%",useBootstrap:!1,content:"Der Podcast, alle enthaltenen Episoden, Links, Themen und Zuordnungen werden gelöscht!",type:"red",buttons:{ok:{text:"ok!",btnClass:"btn-primary",keys:["enter"],action:function(){$.ajax({url:e+"/inc/delete.php?delete_podcast=1",type:"POST",data:{podcast_id:t},success:function(e){console.log(e),t!==a?($("#podcast_list").load(" #podcast_list > *"),$("#podcast_menu").load(" #podcast_menu > *")):location.reload()}})}},cancel:{text:"abbrechen!",action:function(){}}}})}function edituser(e){var t=dirname(window.location.href),a=e;jQuery.ajax({url:t+"/inc/select.php?edit_user=1",data:{pk:a,table:"users"},type:"POST",success:function(e){$("#user_list").hide("slow"),$("#edit").html(e).show("slow")},error:function(){}})}function edit_template(e,t){var a=dirname(window.location.href),n=e;t=t;jQuery.ajax({url:a+"/inc/select.php?edit_template=1",data:{pk:n,table:"episode_templates",podcast_id:t},type:"POST",success:function(e){$("#template_list").hide("slow"),$("#edit").html(e).show("slow")},error:function(){}})}function edit_episode(e){var t=dirname(window.location.href),a=e;jQuery.ajax({url:t+"/inc/select.php?edit_episode=1",data:{pk:a,table:"episoden"},type:"POST",success:function(e){$("#episode_list").hide("slow"),$("#edit").html(e).show("slow")},error:function(){}})}function delete_episode(e){var t=dirname(window.location.href);$.confirm({title:"Episode löschen?",boxWidth:"50%",useBootstrap:!1,content:"Die Episode und alle enthaltenen Beiträge und Themen werden gelöscht!",type:"red",buttons:{ok:{text:"ok!",btnClass:"btn-primary",keys:["enter"],action:function(){$.ajax({url:t+"/inc/delete.php?delete_episode=1",type:"POST",data:{episode_id:e},success:function(e){console.log(e),$("#episode_list").load(" #episode_list > *"),$("#edit").hide("slow"),$("#episode_list").is(":hidden")&&$("#episode_list").show("slow")}})}},cancel:{text:"abbrechen!",action:function(){}}}})}function delete_category(t){var e=dirname(window.location.href);$.confirm({title:"Kategorie löschen?",boxWidth:"50%",useBootstrap:!1,content:"Die Kategorie und alle Links und Themen dieser Kategorie sowie die Zuordnungen zu Vorlagen werden gelöscht!",type:"red",buttons:{ok:{text:"ok!",btnClass:"btn-primary",keys:["enter"],action:function(){jQuery.ajax({url:e+"/inc/delete.php?del_category=1",data:{cat_id:t},type:"POST",success:function(e){console.log(e),$("#category-"+t).remove()},error:function(){}})}},cancel:{text:"abbrechen!",action:function(){}}}})}function edit_episode_cat(e){var t=dirname(window.location.href),a=$("#cat"+e).attr("episode");$("#cat"+e).prop("checked")?$.ajax({url:t+"/inc/check.php?add=1",type:"POST",data:{id:e,episode:a,id_podcast:"ID_EPISODE",table:"episode_categories",column:"ID_CATEGORY"},success:function(e){console.log(e)}}):$.ajax({url:t+"/inc/check.php?remove=1",type:"POST",data:{id:e,episode:a,id_podcast:"ID_EPISODE",table:"episode_categories",column:"ID_CATEGORY"},success:function(e){console.log(e)}})}function edit_episode_user(e){var t=dirname(window.location.href),a=$("#user"+e).attr("episode");$("#user"+e).prop("checked")?$.ajax({url:t+"/inc/check.php?add=1",type:"POST",data:{id:e,episode:a,id_podcast:"ID_EPISODE",table:"episode_users",column:"ID_USER"},success:function(e){console.log(e)}}):$.ajax({url:t+"/inc/check.php?remove=1",type:"POST",data:{id:e,episode:a,id_podcast:"ID_EPISODE",table:"episode_users",column:"ID_USER"},success:function(e){console.log(e)}})}function edit_podcast_user(e){var t=dirname(window.location.href),a=$("#user"+e).attr("podcast");$("#user"+e).prop("checked")?$.ajax({url:t+"/inc/check.php?add=1",type:"POST",data:{id:e,episode:a,id_podcast:"ID_PODCAST",table:"podcast_users",column:"ID_USER"},success:function(e){console.log(e)}}):$.ajax({url:t+"/inc/check.php?remove=1",type:"POST",data:{id:e,episode:a,id_podcast:"ID_PODCAST",table:"podcast_users",column:"ID_USER"},success:function(e){console.log(e)}})}function dirname(e){return e.replace(/\\/g,"/").replace(/\/[^\/]*$/,"")}$(document).ready(function(){var i=dirname(window.location.href);$(".movedownlink").on("click",function(){$(this).parents(".sectionsid").insertAfter($(this).parents(".sectionsid").next()),sendOrderToServer()}),$(".moveuplink").on("click",function(){$(this).parents(".sectionsid").insertBefore($(this).parents(".sectionsid").prev()),sendOrderToServer()}),$(".change").on("click",function(){$("#change").modal("show"),$.ajax({url:i+"/inc/select.php?change=1",type:"POST",data:{},success:function(e){console.log(e),$("#change_content").html(e)}})}),$(".check_version").on("click",function(){$.ajax({url:i+"/inc/select.php?check_version=1",type:"POST",data:{},success:function(e){console.log(e),$("#version_check").html(e)}})}),$("#UserSearch").on("input",function(){""!=$("#UserSearch").val()?($("#user_list").hide("slow"),$("#results").show("slow")):$("#user_list").show("slow");var e=$(this).val(),t=$(this).attr("check");jQuery.ajax({url:i+"/inc/search.php?search_user=1",data:{UserSearch:e,value:t},type:"POST",success:function(e){console.log(e),$("#results").html(e)},error:function(){}})}),$("#update_podcast").on("click",function(){var e=$("#Beschreibung").val(),t=$("#short_edit").val(),a=$("#color_edit").val(),n=$(this).attr("podcast");""!=t?(jQuery.ajax({url:i+"/inc/update.php?podcast_update=1",data:{podcast_desc:e,podcast_short:t,Podcast:n,color:a},type:"POST",success:function(e){console.log(e),$.gritter.add({title:"OK!",text:"Änderungen gespeichert",image:"../images/confirm.png",time:"1000"})},error:function(){}}),$("#pc").load(" #pc > *"),$("#podcast_list").load(" #podcast_list > *"),$("#podcast-name-top").load(" #podcast-name-top > *")):$.gritter.add({title:"Bitte alle Felder ausfüllen!",text:"Bitte gib einen Kurzbezeichner ein!",image:"../images/delete.png",time:"1000"})}),$.fn.editable.defaults.mode="inline",$.fn.editableform.buttons='<button type="submit" class="btn btn-success editable-submit"><i class="fas fa-fw fa-check"></i></button><button type="button" class="btn btn-danger editable-cancel"><i class="fas fa-fw fa-ban"></i></button>',$(".update").editable({params:function(e){var t={};return t.pk=e.pk,t.name=e.name,t.value=e.value,t.table=$(this).attr("table"),t},type:"POST",emptytext:"Nichts hinterlegt",display:function(e){"URL"==$(this).attr("beschr")?$(this).text($(this).attr("beschr")):$(this).text(e)},success:function(e){console.log(e)}}),$(".cat_up").change(function(){var e=$(this).attr("id_cat"),t=$(this).attr("row"),a=$(this).attr("table"),n=$(this).val();if("EXPORT_CAT"==$(this).attr("row")&&$("#export_cat_options_"+e).toggle("slow"),"checkbox"==$(this).attr("type"))if($(this).is(":checked"))n="1";else n="0";$.ajax({url:i+"/inc/update.php?up_cat=1",type:"POST",data:{row:t,pk:e,value:n,table:a},success:function(e){console.log(e)}})}),$("#renew").on("click",function(){$("#Password_add").each(function(){$(this).val(randString($(this)))})}),$("#Password_add").on("click",function(){$(this).select()}),$("#cat_name_new").on("change keyup",function(){""==$(this).val()?$("#cat_add_send").attr("disabled",!0):$("#cat_add_send").removeAttr("disabled")}),$("#cat_coll_new").on("change click",function(){$(this).is(":checked")?($("#cat_visible_new").prop("checked",!0),$("#cat_visible_new").attr("disabled",!0)):($("#cat_visible_new").removeAttr("disabled"),$("#cat_visible_new").prop("checked",!1))}),$("#cat_add_send").click(function(){var e=$("#cat_name_new").val(),t=$(this).attr("podcast");if($("#cat_visible_new").is(":checked"))var a="1";else a="0";if($("#cat_topics_new").is(":checked"))var n="1";else n="0";if($("#cat_coll_new").is(":checked"));else;var s=$("#cat_entries_new").val();""!=e?jQuery.ajax({url:i+"/inc/insert.php?add_cat=1",data:{cat_name:e,cat_visible:a,cat_topics:n,cat_entries:s,podcast:t},type:"POST",success:function(e){$("#cat_name").val(""),console.log(e),location.reload()},error:function(){}}):$.gritter.add({title:"Kein Titel!",text:"Bitte geben Sie einen Titel ein!",image:"../images/delete.png",time:"1000"})}),$("#add_new_episode").click(function(){var e=$("#nummer_add_neu").attr("podcast");if(""!=$("#nummer_add_neu").val()){if($("#template_check").prop("checked"))var t=$("#template_select option:selected").attr("users"),a=$("#template_select option:selected").attr("cats");else t="",a="";$.ajax({url:i+"/inc/insert.php?add_episode=1",type:"POST",data:{podcast:e,date:$("#date_new").val(),title_new:$("#title_new_episode").val(),nummer:$("#nummer_add_neu").val(),users:t,cats:a},success:function(e){console.log(e),$.gritter.add({title:"OK!",text:"Episode angelegt",image:"../images/confirm.png",time:"1000"}),$("#episode_list").load(" #episode_list > *"),$("#nummer_add_neu").val("")}})}else $.gritter.add({title:"Unvollständige Angaben",text:"Bitte gib eine Episoden-Nummer ein!",image:"../images/delete.png",time:"1000"})}),$("#title_template_new, #podcast_template_new").on("change keyup",function(){""==$("#title_template_new").val()||"not"==$("#podcast_template_new option:selected").val()?$("#add_new_template").attr("disabled",!0):$("#add_new_template").removeAttr("disabled")}),$("#add_new_template").click(function(){$.ajax({url:i+"/inc/insert.php?add_template=1",type:"POST",data:{title:$("#title_template_new").val(),podcast:$("#podcast_template_new option:selected").val()},success:function(e){console.log(e),$.gritter.add({title:"OK!",text:"Vorlage angelegt",image:"../images/confirm.png",time:"1000"}),$("#template_list").load(" #template_list > *")}})}),$("#User_add, #Password_add").on("change keyup",function(){var e=$("#User_add").val(),t=$("#Password_add").val();""==e&&""==t?$("#add_user").attr("disabled",!0):$("#add_user").removeAttr("disabled")}),$("#add_user").on("click",function(){var t=$("#User_add").val(),e=$("#User_add_mail").val(),a=$("#Password_add").val();jQuery.ajax({url:i+"/inc/insert.php?add_user=1",data:{User_add:t,User_add_mail:e,Password_add:a},type:"POST",success:function(e){$("#User_add").val(""),$("#User_add_mail").val(""),$("#Password_add").val(""),console.log(e),$.gritter.add({title:"OK!",text:'User "'+t+'" hinzugefügt',image:"../images/confirm.png",time:"1000"}),$("#user_list").load(" #user_list > *")},error:function(){}})}),$("#short").on("change keyup",function(){""==$(this).val()?$("#add_new_podcast").attr("disabled",!0):$("#add_new_podcast").removeAttr("disabled")}),$("#add_new_podcast").click(function(){""!=$("#short").val()?$.ajax({url:i+"/inc/insert.php?add_podcast=1",type:"POST",data:{descr:$("#descr").val(),short:$("#short").val()},success:function(e){location.reload()}}):$.gritter.add({title:"Unvollständige Angaben",text:"Bitte gib einen Kurzbezeichner ein!",image:"../images/delete.png",time:"1000"})}),$("#User_add").on("change input keyup blur",function(){$.ajax({url:i+"/inc/check.php?check_new_user=1",type:"POST",data:{username:$("#User_add").val()},success:function(e){console.log(e),$("#user-availability-status-new").html(e)}})}),$("#short").on("change input keyup blur",function(){$.ajax({url:i+"/inc/check.php?check_podcast_short=1",type:"POST",data:{short:$("#short").val()},success:function(e){console.log(e),$("#podcast-availability-status-new").html(e)}})}),$("#short_edit").on("change input keyup blur",function(){$.ajax({url:i+"/inc/check.php?check_edit_podcast_short=1",type:"POST",data:{short_edit:$("#short_edit").val(),short_cur:$("#short_edit").attr("short_cur")},success:function(e){console.log(e),$("#podcast_edit-availability-status-new").html(e)}})}),$("#nummer_add_neu").on("change input keyup blur",function(){$.ajax({url:i+"/inc/check.php?check_new_episode=1",type:"POST",data:{podcast:$("#nummer_add_neu").attr("podcast"),nummer:$("#nummer_add_neu").val()},success:function(e){console.log(e),$("#number-availability-status-new").html(e)}})})});